using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Text;
using HSRP;
using System.Data;
using DataProvider;
using iTextSharp.text;
using iTextSharp.text.pdf;
using System.Configuration;
using System.IO;
using CarlosAg.ExcelXmlWriter;
using System.Drawing;
//using System.Data.OracleClient;


namespace HSRP.Master
{
    public partial class ApprovalForProductionStatus : System.Web.UI.Page
    {

        string CnnString = string.Empty;
        string SQLString = string.Empty;
        string strUserID = string.Empty;
        string ComputerIP = string.Empty;
        string UserType = string.Empty;
        string HSRPStateID = string.Empty;
        string RTOLocationID = string.Empty;
        int intHSRPStateID;
        string trnasportname, pp;
        string transtr, statename1;
        BaseFont basefont;
        string fontpath;

        string AllLocation = string.Empty;
        string OrderStatus = string.Empty;
        DateTime AuthorizationDate;
        DateTime OrderDate1;
        DataProvider.BAL bl = new DataProvider.BAL();
        BAL obj = new BAL();
        string StickerManditory = string.Empty;
        DataTable dataSetFillHSRPRecord;
        protected void Page_Load(object sender, EventArgs e)
        {
            Utils.GZipEncodePage();
            if (Session["UID"] == null)
            {
                Response.Redirect("~/Login.aspx", true);
            }
            else
            {


                CnnString = System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionString"].ToString();

                RTOLocationID = Session["UserRTOLocationID"].ToString();
                UserType = Session["UserType"].ToString();
                HSRPStateID = Session["UserHSRPStateID"].ToString();

                lblErrMsg.Text = string.Empty;
                strUserID = Session["UID"].ToString();
                ComputerIP = Request.UserHostAddress;

                if (!IsPostBack)
                {
                    InitialSetting();
                    if (HSRPStateID == "9")
                    {
                        ddlBothDealerHHT.Visible = false;
                        labelSelectType.Visible = false;
                    }
                    else if (HSRPStateID == "4")
                    {
                        ddlBothDealerHHT.Visible = true;
                        labelSelectType.Visible = true;
                        DropDownList1.Visible = true;
                        labelvehicletype.Visible = true;
                    }
                    else if (HSRPStateID == "2")
                    {
                        ddlBothDealerHHT.Visible = true;
                        labelSelectType.Visible = true;
                        DropDownList1.Visible = true;
                        labelvehicletype.Visible = true;
                    }
                    else
                    {
                        DropDownList1.Visible = false;
                        labelvehicletype.Visible = false;
                    }
                    try
                    {

                        if (UserType == "0")
                        {
                            labelOrganization.Visible = true;
                            DropDownListStateName.Visible = true;
                            DropDownListStateName.Enabled = true;
                            labelClient.Visible = true;
                            dropDownListClient.Visible = true;
                            FilldropDownListOrganization();
                            FilldropDownListClient();
                        }
                        else
                        {
                            hiddenUserType.Value = "1";
                            labelOrganization.Enabled = false;
                            DropDownListStateName.Enabled = false;
                            labelClient.Enabled = false;
                            FilldropDownListOrganization();
                            FilldropDownListClient();
                            //buildGrid();

                        }


                    }
                    catch (Exception err)
                    {
                        lblErrMsg.Text = "Error on Page Load" + err.Message.ToString();
                    }
                }
            }
        }

        #region DropDown



        private void FilldropDownListOrganization()
        {
            if (UserType == "0")
            {
                SQLString = "select HSRPStateName,HSRP_StateID from HSRPState  where ActiveStatus='Y' Order by HSRPStateName";
                Utils.PopulateDropDownList(DropDownListStateName, SQLString.ToString(), CnnString, "--Select State--");
                // DropDownListStateName.SelectedIndex = DropDownListStateName.Items.Count - 1;

            }
            else
            {
                SQLString = "select HSRPStateName,HSRP_StateID from HSRPState  where HSRP_StateID=" + HSRPStateID + " and ActiveStatus='Y' Order by HSRPStateName";
                DataTable dts = Utils.GetDataTable(SQLString, CnnString);
                DropDownListStateName.DataSource = dts;
                DropDownListStateName.DataBind();
            }
        }
        private void FilldropDownListClient()
        {
            if (UserType == "0")
            {

                int.TryParse(DropDownListStateName.SelectedValue, out intHSRPStateID);

                //SQLString = "select RTOLocationName,RTOLocationID from RTOLocation Where HSRP_StateID=" + HSRPStateID + " and ActiveStatus!='N'   Order by RTOLocationName";
                SQLString = "select RTOLocationName,RTOLocationID from RTOLocation Where HSRP_StateID=" + intHSRPStateID + " and ActiveStatus!='N'   Order by RTOLocationName";
                Utils.PopulateDropDownList(dropDownListClient, SQLString.ToString(), CnnString, "--Select RTO Name--");

                dataLabellbl.Visible = false;
                TRRTOHide.Visible = false;
            }
            else
            {
                string UserID = Convert.ToString(Session["UID"]);

                SQLString = "SELECT  distinct (a.RTOLocationName) as RTOLocationName, (a.RTOLocationCode+', ') as RTOCode, a.RTOLocationID FROM UserRTOLocationMapping INNER JOIN RTOLocation a ON UserRTOLocationMapping.RTOLocationID = a.RTOLocationID where UserRTOLocationMapping.UserID='" + UserID + "' ";
                DataTable dss = Utils.GetDataTable(SQLString, CnnString);

                labelOrganization.Visible = true;
                DropDownListStateName.Visible = true;
                labelClient.Visible = true;
                dropDownListClient.Visible = true;

                dropDownListClient.DataSource = dss;
                dropDownListClient.DataBind();
                dataLabellbl.Visible = true;

                string RTOCode = string.Empty;
                if (dss.Rows.Count > 0)
                {
                    for (int i = 0; i <= dss.Rows.Count - 1; i++)
                    {
                        RTOCode += dss.Rows[i]["RTOCode"].ToString() + ",";

                    }
                    lblRTOCode.Text = RTOCode.Remove(RTOCode.LastIndexOf(","));

                }
            }
        }
        protected void dropDownListClient_SelectedIndexChanged(object sender, EventArgs e)
        {

            //if (DropDownListStateName.SelectedItem.Text != "--Select Client--")
            //{
            //    ShowGrid();
            //}
            //else
            //{
            //    Grid1.Items.Clear();
            //    lblErrMsg.Text = String.Empty;
            //    lblErrMsg.Text = "Please Select Client.";
            //    return;
            //}
        }
        #endregion






        protected void DropDownListStateName_SelectedIndexChanged(object sender, EventArgs e)
        {
            try
            {
                FilldropDownListClient();
                dropDownListClient.Visible = true;
                labelClient.Visible = true;
            }
            catch (Exception ex)
            {
                lblErrMsg.Text = "Please Contact to  Adminstrator with Screen Shot. Error: " + ex.Message.ToString();
            }
        }

        private void InitialSetting()
        {
            try
            {
                string TodayDate = System.DateTime.Now.Year.ToString() + "-" + System.DateTime.Now.Month.ToString() + "-" + System.DateTime.Now.Day.ToString();
                string MaxDate = System.DateTime.Now.Year.ToString() + "-" + System.DateTime.Now.Month.ToString() + "-" + System.DateTime.Now.Day.ToString();
                HSRPAuthDate.SelectedDate = (DateTime.Parse(TodayDate)).AddDays(0.00);
                HSRPAuthDate.MaxDate = DateTime.Parse(MaxDate);
                CalendarHSRPAuthDate.SelectedDate = (DateTime.Parse(TodayDate)).AddDays(0.00);
                CalendarHSRPAuthDate.VisibleDate = (DateTime.Parse(TodayDate)).AddDays(0.00);
                OrderDate.SelectedDate = (DateTime.Parse(TodayDate)).AddDays(-3.00);
                OrderDate.MaxDate = DateTime.Parse(MaxDate);
                CalendarOrderDate.SelectedDate = (DateTime.Parse(TodayDate)).AddDays(0.00);
                CalendarOrderDate.VisibleDate = (DateTime.Parse(TodayDate)).AddDays(0.00);
            }
            catch (Exception ex)
            {
                lblErrMsg.Text = "Please Contact to  Adminstrator with Screen Shot. Error: " + ex.Message.ToString();
            }
        }


        protected void btnDownloadRecords_Click(object sender, EventArgs e)
        {
            try
            {
                lblErrMsg.Text = "";
                // DataTable dt = new DataTable(); 
                BAL obj = new BAL();
                string type = "2";
                String[] StringAuthDate = OrderDate.SelectedDate.ToString().Split('/');
                string MonTo = ("0" + StringAuthDate[0]);
                string MonthdateTO = MonTo.Replace("00", "0").Replace("01", "1");
                String ReportDateFrom = StringAuthDate[1] + "/" + MonthdateTO + "/" + StringAuthDate[2].Split(' ')[0];
                String From = StringAuthDate[0] + "/" + StringAuthDate[1] + "/" + StringAuthDate[2].Split(' ')[0];

                string AuthorizationDate = From + " 00:00:00";
                String[] StringOrderDate = HSRPAuthDate.SelectedDate.ToString().Split('/');
                string Mon = ("0" + StringOrderDate[0]);
                string Monthdate = Mon.Replace("00", "0").Replace("01", "1");
                String FromDate = StringOrderDate[1] + "-" + Monthdate + "-" + StringOrderDate[2].Split(' ')[0];
                String ReportDateTo = StringOrderDate[1] + "/" + Monthdate + "/" + StringOrderDate[2].Split(' ')[0];
                String From1 = StringOrderDate[0] + "/" + StringOrderDate[1] + "/" + StringOrderDate[2].Split(' ')[0];
                string ToDate = From1 + " 23:59:59";

                DateTime serverdate = DateTime.Parse((DateTime.Now.ToString("yyyy-MM-dd").ToString()));
                DateTime serverdate1 = serverdate.AddDays(-5);
                DateTime serverdate11 = serverdate.AddDays(-7);
                string from2 = From1 + " 00:00:00";
                string from3 = From + " 00:00:00";

                //if (HSRPStateID == "5" && DateTime.Parse(from2) <= serverdate1)
                //if ((HSRPStateID == "4" && DateTime.Parse(from2) <= serverdate11))
                //{
                //    lblErrMsg.Text = "Only Four(6) Days Previous date can be Selected";
                //}
                HSRPStateID = DropDownListStateName.SelectedValue.ToString();
                if ((HSRPStateID == "5" && DateTime.Parse(from2) <= serverdate1))
                {
                    lblErrMsg.Text = "Only Four(4) Days Previous date can be Selected";
                }
                else if ((HSRPStateID == "5" && DateTime.Parse(from3) <= serverdate1))
                {
                    lblErrMsg.Text = "Only Four(4) Days Previous date can be Selected";
                }
                else
                {
                    if (HSRPStateID == "1")
                    {
                        if (ddlBothDealerHHT.SelectedItem.Text == "Both")
                        {
                            SQLString = "Select   a.hsrprecordID,a.netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate," +
                                " CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate, " +
                                " left(a.OwnerName,19) as OwnerName, a.MobileNo,Af.AffixCenterDesc, a.HSRPRecordID, CONVERT(varchar(20)," +
                                " HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo," +
                                "  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when" +
                                " 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when" +
                                " 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID," +
                                " s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode," +
                                " left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode," +
                                " a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize =" +
                                " Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID =" +
                                " b.RTOLocationID Left JOIN AffixationCenters Af on a.affix_id=Af.Affix_id where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue +
                                "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and HSRPRecord_creationdate between '" + AuthorizationDate + "' and  '" +
                                ToDate + "'  order by Af.AffixCenterDesc";
                        }
                        else if (ddlBothDealerHHT.SelectedItem.Text == "Dealer Data")
                        {
                            SQLString = "Select   a.hsrprecordID,a.netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo,Af.AffixCenterDesc, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate,a.mobileNo, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID Left JOIN AffixationCenters Af on a.affix_id=Af.Affix_id where ApproveProductionStatus='N' and" +
                                " a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue
                                + "' and HSRPRecord_creationdate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.Addrecordby like'%dealer%'  order by Af.AffixCenterDesc";
                        }
                        else if (ddlBothDealerHHT.SelectedItem.Text == "HHT Data")
                        {
                            SQLString = "Select   a.hsrprecordID,a.netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo,Af.AffixCenterDesc, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate,a.mobileNo, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID Left JOIN AffixationCenters Af on a.affix_id=Af.Affix_id " +
                                "where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue
                                + "' and HSRPRecord_creationdate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.Addrecordby like'%HHT%'  order by Af.AffixCenterDesc";
                        }
                        else if (ddlBothDealerHHT.SelectedItem.Text == "Other")
                        {
                            SQLString = "Select   a.hsrprecordID,a.netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo,Af.AffixCenterDesc, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate,a.mobileNo, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID Left JOIN AffixationCenters Af on a.affix_id=Af.Affix_id where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and HSRPRecord_creationdate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.Addrecordby is null order by Af.AffixCenterDesc";
                        }
                    }

                    else if (HSRPStateID == "4")
                    {

                        if (ddlBothDealerHHT.SelectedItem.Text == "Both")
                        {
                            if (DropDownList1.SelectedItem.ToString().ToUpper() == "ALL")
                            {
                                //10feb SQLString = "Select   a.hsrprecordID,a.roundoff_netamount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID   where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and HsrpRecord_creationdate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.orderstatus='New Order' and [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null order by a.VehicleClass,a.VehicleType,a.VehicleRegNo ";
                                SQLString = "Select   a.hsrprecordID,a.RoundOff_NetAmount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo,a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID  where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and hsrprecord_CreationDate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.orderstatus='New Order' and [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null order by a.VehicleClass,a.VehicleType,a.HSRP_Front_LaserCode,a.hsrp_rear_lasercode";
                            }
                            else if (DropDownList1.SelectedItem.ToString().ToUpper() == "TWO WHEELER")
                            {
                                SQLString = "Select   a.hsrprecordID,a.roundoff_netamount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID   where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and HsrpRecord_creationdate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.orderstatus='New Order' and vehicletype in ('MOTOR CYCLE','SCOOTER') and [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null order by a.VehicleClass,a.VehicleType,a.HSRP_Front_LaserCode,a.hsrp_rear_lasercode ";
                                // SQLString = "Select   a.hsrprecordID,a.RoundOff_NetAmount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and hsrprecord_CreationDate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.orderstatus='New Order' and vehicletype in ('MOTOR CYCLE','SCOOTER') and [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null order by a.VehicleClass,a.VehicleType,a.VehicleRegNo";
                            }
                            else if (DropDownList1.SelectedItem.ToString().ToUpper() == "THREE WHEELER")
                            {
                                SQLString = "Select   a.hsrprecordID,a.roundoff_netamount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID   where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and HsrpRecord_creationdate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.orderstatus='New Order' and vehicletype in ('THREE WHEELER') and [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null order by a.VehicleClass,a.VehicleType,a.HSRP_Front_LaserCode,a.hsrp_rear_lasercode ";
                                //SQLString = "Select   a.hsrprecordID,a.RoundOff_NetAmount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and hsrprecord_CreationDate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.orderstatus='New Order' and vehicletype in ('THREE WHEELER') and [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null order by a.VehicleClass,a.VehicleType,a.VehicleRegNo";
                            }
                            else if (DropDownList1.SelectedItem.ToString().ToUpper() == "FOUR WHEELER")
                            {
                                SQLString = "Select   a.hsrprecordID,a.roundoff_netamount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID   where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and HsrpRecord_creationdate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.orderstatus='New Order' and vehicletype in ('LMV','LMV(CLASS)','MCV/HCV/TRAILERS','TRACTOR') and [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null order by a.VehicleClass,a.VehicleType,a.HSRP_Front_LaserCode,a.hsrp_rear_lasercode ";
                                //SQLString = "Select   a.hsrprecordID,a.RoundOff_NetAmount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and hsrprecord_CreationDate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.orderstatus='New Order' and vehicletype in ('LMV','LMV(CLASS)','MCV/HCV/TRAILERS','TRACTOR') and [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null order by a.VehicleClass,a.VehicleType,a.VehicleRegNo";
                            }

                            //SQLString = "Select   a.hsrprecordID,a.netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID   where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and PlateAffixationDate between '" + AuthorizationDate + "' and  '" + ToDate + "' order by a.VehicleClass,a.VehicleType,a.VehicleRegNo ";
                        }
                        else if (ddlBothDealerHHT.SelectedItem.Text == "Dealer Data")
                        {
                            if (DropDownList1.SelectedItem.ToString().ToUpper() == "ALL")
                            {
                                SQLString = "Select   a.hsrprecordID,a.roundoff_netamount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate, a.dealerid as ID, left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate,a.mobileNo, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and HsrpRecord_creationdate between '" + AuthorizationDate + "' and  '" + ToDate + "' and   a.orderstatus='New Order' and [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null AND a.Addrecordby like'%dealer%' order by a.VehicleClass,a.VehicleType,a.dealerid, a.HSRP_Front_LaserCode,a.hsrp_rear_lasercode";
                                //SQLString = "Select   a.hsrprecordID,a.RoundOff_NetAmount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo,a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID  where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and hsrprecord_CreationDate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.orderstatus='New Order' and [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null order by a.VehicleClass,a.VehicleType,a.VehicleRegNo";
                            }
                            else if (DropDownList1.SelectedItem.ToString().ToUpper() == "TWO WHEELER")
                            {
                                SQLString = "Select   a.hsrprecordID,a.roundoff_netamount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,a.dealerid as ID, left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate,a.mobileNo, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and HsrpRecord_creationdate between '" + AuthorizationDate + "' and  '" + ToDate + "' and   a.orderstatus='New Order' and vehicletype in ('MOTOR CYCLE','SCOOTER') and [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null AND a.Addrecordby like'%dealer%' order by a.VehicleClass,a.VehicleType,a.dealerid, a.HSRP_Front_LaserCode,a.hsrp_rear_lasercode";
                                //SQLString = "Select   a.hsrprecordID,a.RoundOff_NetAmount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and hsrprecord_CreationDate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.orderstatus='New Order' and vehicletype in ('MOTOR CYCLE','SCOOTER') and [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null order by a.VehicleClass,a.VehicleType,a.VehicleRegNo";
                            }
                            else if (DropDownList1.SelectedItem.ToString().ToUpper() == "THREE WHEELER")
                            {
                                SQLString = "Select   a.hsrprecordID,a.roundoff_netamount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,a.dealerid as ID, left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate,a.mobileNo, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and HsrpRecord_creationdate between '" + AuthorizationDate + "' and  '" + ToDate + "' and   a.orderstatus='New Order' and vehicletype in ('THREE WHEELER') and [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null AND a.Addrecordby like'%dealer%' order by a.VehicleClass,a.VehicleType,a.dealerid, a.HSRP_Front_LaserCode,a.hsrp_rear_lasercode";
                                //SQLString = "Select   a.hsrprecordID,a.RoundOff_NetAmount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and hsrprecord_CreationDate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.orderstatus='New Order' and vehicletype in ('THREE WHEELER') and [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null order by a.VehicleClass,a.VehicleType,a.VehicleRegNo";
                            }
                            else if (DropDownList1.SelectedItem.ToString().ToUpper() == "FOUR WHEELER")
                            {
                                SQLString = "Select   a.hsrprecordID,a.roundoff_netamount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,a.dealerid as ID,left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate,a.mobileNo, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and HsrpRecord_creationdate between '" + AuthorizationDate + "' and  '" + ToDate + "' and   a.orderstatus='New Order' and vehicletype in ('LMV','LMV(CLASS)','MCV/HCV/TRAILERS','TRACTOR') and [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null AND a.Addrecordby like'%dealer%' order by a.VehicleClass,a.VehicleType,a.dealerid,a.HSRP_Front_LaserCode,a.hsrp_rear_lasercode";
                                //SQLString = "Select   a.hsrprecordID,a.RoundOff_NetAmount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and hsrprecord_CreationDate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.orderstatus='New Order' and vehicletype in ('LMV','LMV(CLASS)','MCV/HCV/TRAILERS','TRACTOR') and [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null order by a.VehicleClass,a.VehicleType,a.VehicleRegNo";
                            }

                            //SQLString = "Select   a.hsrprecordID,a.netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate,a.mobileNo, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and PlateAffixationDate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.Addrecordby like'%dealer%' order by a.VehicleClass,a.VehicleType,a.VehicleRegNo";
                        }
                        else if (ddlBothDealerHHT.SelectedItem.Text == "HHT Data")
                        {
                            if (DropDownList1.SelectedItem.ToString().ToUpper() == "ALL")
                            {
                                SQLString = "Select   a.hsrprecordID,a.roundoff_netamount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate,a.mobileNo, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID  where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and HsrpRecord_creationdate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.orderstatus='New Order' and [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null AND a.Addrecordby like'%HHT%'  order by a.VehicleClass,a.VehicleType,a.HSRP_Front_LaserCode,a.hsrp_rear_lasercode";
                                //SQLString = "Select   a.hsrprecordID,a.RoundOff_NetAmount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo,a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID  where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and hsrprecord_CreationDate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.orderstatus='New Order' and [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null order by a.VehicleClass,a.VehicleType,a.VehicleRegNo";
                            }
                            else if (DropDownList1.SelectedItem.ToString().ToUpper() == "TWO WHEELER")
                            {
                                SQLString = "Select   a.hsrprecordID,a.roundoff_netamount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate,a.mobileNo, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID  where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and HsrpRecord_creationdate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.orderstatus='New Order' and vehicletype in ('MOTOR CYCLE','SCOOTER') AND [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null AND a.Addrecordby like'%HHT%'  order by a.VehicleClass,a.VehicleType,a.HSRP_Front_LaserCode,a.hsrp_rear_lasercode";
                                //SQLString = "Select   a.hsrprecordID,a.RoundOff_NetAmount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and hsrprecord_CreationDate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.orderstatus='New Order' and vehicletype in ('MOTOR CYCLE','SCOOTER') and [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null order by a.VehicleClass,a.VehicleType,a.VehicleRegNo";
                            }
                            else if (DropDownList1.SelectedItem.ToString().ToUpper() == "THREE WHEELER")
                            {
                                SQLString = "Select   a.hsrprecordID,a.roundoff_netamount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate,a.mobileNo, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID  where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and HsrpRecord_creationdate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.orderstatus='New Order' and vehicletype in ('THREE WHEELER') AND [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null AND a.Addrecordby like'%HHT%'  order by a.VehicleClass,a.VehicleType,a.HSRP_Front_LaserCode,a.hsrp_rear_lasercode";
                                //SQLString = "Select   a.hsrprecordID,a.RoundOff_NetAmount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and hsrprecord_CreationDate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.orderstatus='New Order' and vehicletype in ('THREE WHEELER') and [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null order by a.VehicleClass,a.VehicleType,a.VehicleRegNo";
                            }
                            else if (DropDownList1.SelectedItem.ToString().ToUpper() == "FOUR WHEELER")
                            {
                                SQLString = "Select   a.hsrprecordID,a.roundoff_netamount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate,a.mobileNo, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID  where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and HsrpRecord_creationdate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.orderstatus='New Order' and vehicletype in ('LMV','LMV(CLASS)','MCV/HCV/TRAILERS','TRACTOR') AND [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null AND a.Addrecordby like'%HHT%'  order by a.VehicleClass,a.VehicleType,a.HSRP_Front_LaserCode,a.hsrp_rear_lasercode";
                                //SQLString = "Select   a.hsrprecordID,a.RoundOff_NetAmount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and hsrprecord_CreationDate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.orderstatus='New Order' and vehicletype in ('LMV','LMV(CLASS)','MCV/HCV/TRAILERS','TRACTOR') and [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null order by a.VehicleClass,a.VehicleType,a.VehicleRegNo";
                            }
                            //SQLString = "Select   a.hsrprecordID,a.netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate,a.mobileNo, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID  where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and PlateAffixationDate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.Addrecordby like'%HHT%'  order by a.VehicleClass,a.VehicleType,a.VehicleRegNo";
                        }
                        else if (ddlBothDealerHHT.SelectedItem.Text == "Other")
                        {
                            if (DropDownList1.SelectedItem.ToString().ToUpper() == "ALL")
                            {
                                SQLString = "Select   a.hsrprecordID,a.roundoff_netamount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate,a.mobileNo, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID  where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and HsrpRecord_creationdate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.orderstatus='New Order' and [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null AND a.Addrecordby is null order by a.VehicleClass,a.VehicleType,a.HSRP_Front_LaserCode,a.hsrp_rear_lasercode";
                                //SQLString = "Select   a.hsrprecordID,a.RoundOff_NetAmount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo,a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID  where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and hsrprecord_CreationDate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.orderstatus='New Order' and [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null order by a.VehicleClass,a.VehicleType,a.VehicleRegNo";
                            }
                            else if (DropDownList1.SelectedItem.ToString().ToUpper() == "TWO WHEELER")
                            {
                                SQLString = "Select   a.hsrprecordID,a.roundoff_netamount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate,a.mobileNo, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID  where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and HsrpRecord_creationdate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.orderstatus='New Order' and [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null AND vehicletype in ('MOTOR CYCLE','SCOOTER') AND a.Addrecordby is null order by a.VehicleClass,a.VehicleType,a.HSRP_Front_LaserCode,a.hsrp_rear_lasercode";
                                //SQLString = "Select   a.hsrprecordID,a.RoundOff_NetAmount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and hsrprecord_CreationDate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.orderstatus='New Order' and vehicletype in ('MOTOR CYCLE','SCOOTER') and [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null order by a.VehicleClass,a.VehicleType,a.VehicleRegNo";
                            }
                            else if (DropDownList1.SelectedItem.ToString().ToUpper() == "THREE WHEELER")
                            {
                                SQLString = "Select   a.hsrprecordID,a.roundoff_netamount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate,a.mobileNo, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID  where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and HsrpRecord_creationdate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.orderstatus='New Order' and [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null AND vehicletype in ('THREE WHEELER') AND a.Addrecordby is null order by a.VehicleClass,a.VehicleType,a.HSRP_Front_LaserCode,a.hsrp_rear_lasercode";
                                //SQLString = "Select   a.hsrprecordID,a.RoundOff_NetAmount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and hsrprecord_CreationDate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.orderstatus='New Order' and vehicletype in ('THREE WHEELER') and [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null order by a.VehicleClass,a.VehicleType,a.VehicleRegNo";
                            }
                            else if (DropDownList1.SelectedItem.ToString().ToUpper() == "FOUR WHEELER")
                            {
                                SQLString = "Select   a.hsrprecordID,a.roundoff_netamount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate,a.mobileNo, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID  where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and HsrpRecord_creationdate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.orderstatus='New Order' and [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null AND vehicletype in ('LMV','LMV(CLASS)','MCV/HCV/TRAILERS','TRACTOR') AND a.Addrecordby is null order by a.VehicleClass,a.VehicleType,a.HSRP_Front_LaserCode,a.hsrp_rear_lasercode";
                                //SQLString = "Select   a.hsrprecordID,a.RoundOff_NetAmount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and hsrprecord_CreationDate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.orderstatus='New Order' and vehicletype in ('LMV','LMV(CLASS)','MCV/HCV/TRAILERS','TRACTOR') and [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null order by a.VehicleClass,a.VehicleType,a.VehicleRegNo";
                            }
                            // SQLString = "Select   a.hsrprecordID,a.netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate,a.mobileNo, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID  where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and PlateAffixationDate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.Addrecordby is null order by a.VehicleClass,a.VehicleType,a.VehicleRegNo";
                        }
                    }

                    else if (HSRPStateID == "5")
                    {

                        if (ddlBothDealerHHT.SelectedItem.Text == "Both")
                        {
                            SQLString = "Select   a.hsrprecordID,a.netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID   where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and PlateAffixationDate between '" + AuthorizationDate + "' and  '" + ToDate + "' order by a.VehicleClass,a.VehicleType,a.VehicleRegNo ";
                        }
                        else if (ddlBothDealerHHT.SelectedItem.Text == "Dealer Data")
                        {
                            SQLString = "Select   a.hsrprecordID,a.netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate,a.mobileNo, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and PlateAffixationDate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.Addrecordby like'%dealer%' order by a.VehicleClass,a.VehicleType,a.VehicleRegNo";
                        }
                        else if (ddlBothDealerHHT.SelectedItem.Text == "HHT Data")
                        {
                            SQLString = "Select   a.hsrprecordID,a.netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate,a.mobileNo, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID  where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and PlateAffixationDate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.Addrecordby like'%HHT%'  order by a.VehicleClass,a.VehicleType,a.VehicleRegNo";
                        }
                        else if (ddlBothDealerHHT.SelectedItem.Text == "Other")
                        {
                            SQLString = "Select   a.hsrprecordID,a.netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate,a.mobileNo, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID  where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and PlateAffixationDate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.Addrecordby is null order by a.VehicleClass,a.VehicleType,a.VehicleRegNo";
                        }
                    }
                    else if (HSRPStateID == "9")
                    {
                        //SQLString = "Select   a.hsrprecordID,a.netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo,Af.AffixCenterDesc, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID INNER JOIN AffixationCenters Af on a.affix_id=Af.Affix_id where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and hsrprecord_CreationDate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.orderstatus='New Order' and [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null order by Af.AffixCenterDesc";
                        if (DropDownList1.SelectedItem.ToString().ToUpper() == "ALL")
                        {
                            SQLString = "Select   a.hsrprecordID,a.RoundOff_NetAmount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo,a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID  where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and hsrprecord_CreationDate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.orderstatus='New Order' and [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null order by a.VehicleClass,a.VehicleType,a.HSRP_Front_LaserCode,a.hsrp_rear_lasercode";
                        }
                        else if (DropDownList1.SelectedItem.ToString().ToUpper() == "TWO WHEELER")
                        {
                            SQLString = "Select   a.hsrprecordID,a.RoundOff_NetAmount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and hsrprecord_CreationDate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.orderstatus='New Order' and vehicletype in ('MOTOR CYCLE','SCOOTER') and [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null order by a.VehicleClass,a.VehicleType,a.HSRP_Front_LaserCode,a.hsrp_rear_lasercode";
                        }
                        else if (DropDownList1.SelectedItem.ToString().ToUpper() == "THREE WHEELER")
                        {
                            SQLString = "Select   a.hsrprecordID,a.RoundOff_NetAmount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and hsrprecord_CreationDate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.orderstatus='New Order' and vehicletype in ('THREE WHEELER') and [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null order by a.VehicleClass,a.VehicleType,a.HSRP_Front_LaserCode,a.hsrp_rear_lasercode";
                        }
                        else if (DropDownList1.SelectedItem.ToString().ToUpper() == "FOUR WHEELER")
                        {
                            SQLString = "Select   a.hsrprecordID,a.RoundOff_NetAmount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and hsrprecord_CreationDate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.orderstatus='New Order' and vehicletype in ('LMV','LMV(CLASS)','MCV/HCV/TRAILERS','TRACTOR') and [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null order by a.VehicleClass,a.VehicleType,a.HSRP_Front_LaserCode,a.hsrp_rear_lasercode";
                        }
                    }
                    else if (HSRPStateID == "2")
                    {

                        if (ddlBothDealerHHT.SelectedItem.Text == "Both")
                        {
                            if (DropDownList1.SelectedItem.ToString().ToUpper() == "ALL")
                            {
                                SQLString = "Select   a.hsrprecordID,a.RoundOff_NetAmount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo,a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID  where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and hsrprecord_CreationDate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.orderstatus='New Order' and [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null order by a.VehicleClass,a.VehicleType,a.VehicleRegNo";
                            }
                            else if (DropDownList1.SelectedItem.ToString().ToUpper() == "TWO WHEELER")
                            {
                                // SQLString = "Select   a.hsrprecordID,a.roundoff_netamount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID   where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and HsrpRecord_creationdate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.orderstatus='New Order' and vehicletype in ('MOTOR CYCLE','SCOOTER') and [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null order by a.VehicleClass,a.VehicleType,a.VehicleRegNo ";
                                SQLString = "Select   a.hsrprecordID,a.roundoff_netamount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate,a.mobileNo, a.EngineNo, a.ChassisNo, (select rtolocationname from rtolocation where rtolocationid=a.rtolocationid) RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass, a.HSRP_StateID, (select HSRPStateName from HSRPState where hsrp_stateid=a.hsrp_stateid) HSRPStateName, left (replace ((select productcode from product where productid=a.rearplatesize),'MM-',''),9) AS RearProductCode, left (replace ((select productcode from product where productid=a.frontplatesize),'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a   where  ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and HsrpRecord_creationdate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.orderstatus='New Order' and [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null AND  vehicletype in ('SCOOTER','MOTOR CYCLE')  order by a.VehicleClass,a.VehicleType,a.VehicleRegNo";
                            }
                            else if (DropDownList1.SelectedItem.ToString().ToUpper() == "THREE WHEELER")
                            {
                                //SQLString = "Select   a.hsrprecordID,a.roundoff_netamount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID   where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and HsrpRecord_creationdate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.orderstatus='New Order' and vehicletype in ('THREE WHEELER') and [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null order by a.VehicleClass,a.VehicleType,a.VehicleRegNo ";
                                SQLString = "Select   a.hsrprecordID,a.roundoff_netamount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate,a.mobileNo, a.EngineNo, a.ChassisNo, (select rtolocationname from rtolocation where rtolocationid=a.rtolocationid) RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass, a.HSRP_StateID, (select HSRPStateName from HSRPState where hsrp_stateid=a.hsrp_stateid) HSRPStateName, left (replace ((select productcode from product where productid=a.rearplatesize),'MM-',''),9) AS RearProductCode, left (replace ((select productcode from product where productid=a.frontplatesize),'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a   where ApproveProductionStatus='N' and  a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and HsrpRecord_creationdate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.orderstatus='New Order' and [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null AND vehicletype in ('THREE WHEELER')  order by a.VehicleClass,a.VehicleType,a.VehicleRegNo";
                            }
                            else if (DropDownList1.SelectedItem.ToString().ToUpper() == "FOUR WHEELER")
                            {
                                //SQLString = "Select   a.hsrprecordID,a.roundoff_netamount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID   where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and HsrpRecord_creationdate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.orderstatus='New Order' and vehicletype in ('LMV','LMV(CLASS)','MCV/HCV/TRAILERS','TRACTOR') and [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null order by a.VehicleClass,a.VehicleType,a.VehicleRegNo ";
                                SQLString = "Select   a.hsrprecordID,a.roundoff_netamount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate,a.mobileNo, a.EngineNo, a.ChassisNo, (select rtolocationname from rtolocation where rtolocationid=a.rtolocationid) RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass, a.HSRP_StateID, (select HSRPStateName from HSRPState where hsrp_stateid=a.hsrp_stateid) HSRPStateName, left (replace ((select productcode from product where productid=a.rearplatesize),'MM-',''),9) AS RearProductCode, left (replace ((select productcode from product where productid=a.frontplatesize),'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a   where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and HsrpRecord_creationdate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.orderstatus='New Order' and [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null  AND vehicletype in ('LMV','LMV(CLASS)','MCV/HCV/TRAILERS','TRACTOR')  order by a.VehicleClass,a.VehicleType,a.VehicleRegNo";
                            }

                            //SQLString = "Select   a.hsrprecordID,a.netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID   where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and PlateAffixationDate between '" + AuthorizationDate + "' and  '" + ToDate + "' order by a.VehicleClass,a.VehicleType,a.VehicleRegNo ";
                        }
                        else if (ddlBothDealerHHT.SelectedItem.Text == "Dealer Data")
                        {
                            if (DropDownList1.SelectedItem.ToString().ToUpper() == "ALL")
                            {
                                // SQLString = "Select   a.hsrprecordID,a.roundoff_netamount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate,a.mobileNo, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and HsrpRecord_creationdate between '" + AuthorizationDate + "' and  '" + ToDate + "' and   a.orderstatus='New Order' and [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null AND a.Addrecordby like'%dealer%' order by a.VehicleClass,a.VehicleType,a.VehicleRegNo";
                                SQLString = "Select   a.hsrprecordID,a.roundoff_netamount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate,a.mobileNo, a.EngineNo, a.ChassisNo, (select rtolocationname from rtolocation where rtolocationid=a.rtolocationid) RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass, a.HSRP_StateID, (select HSRPStateName from HSRPState where hsrp_stateid=a.hsrp_stateid) HSRPStateName, left (replace ((select productcode from product where productid=a.rearplatesize),'MM-',''),9) AS RearProductCode, left (replace ((select productcode from product where productid=a.frontplatesize),'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a   where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and HsrpRecord_creationdate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.orderstatus='New Order' and [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null and (a.Addrecordby ='Dealer') order by a.VehicleClass,a.VehicleType,a.VehicleRegNo";
                            }
                            else if (DropDownList1.SelectedItem.ToString().ToUpper() == "TWO WHEELER")
                            {
                                //SQLString = "Select   a.hsrprecordID,a.roundoff_netamount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate,a.mobileNo, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID where a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and HsrpRecord_creationdate between '" + AuthorizationDate + "' and  '" + ToDate + "' and   a.orderstatus='New Order' and vehicletype in ('MOTOR CYCLE','SCOOTER') and [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null AND a.Addrecordby like'%dealer%' order by a.VehicleClass,a.VehicleType,a.VehicleRegNo";
                                SQLString = "Select   a.hsrprecordID,a.roundoff_netamount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate,a.mobileNo, a.EngineNo, a.ChassisNo, (select rtolocationname from rtolocation where rtolocationid=a.rtolocationid) RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass, a.HSRP_StateID, (select HSRPStateName from HSRPState where hsrp_stateid=a.hsrp_stateid) HSRPStateName, left (replace ((select productcode from product where productid=a.rearplatesize),'MM-',''),9) AS RearProductCode, left (replace ((select productcode from product where productid=a.frontplatesize),'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a   where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and HsrpRecord_creationdate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.orderstatus='New Order' and [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null AND   vehicletype in ('SCOOTER','MOTOR CYCLE') and (a.Addrecordby ='Dealer') order by a.VehicleClass,a.VehicleType,a.VehicleRegNo";
                            }
                            else if (DropDownList1.SelectedItem.ToString().ToUpper() == "THREE WHEELER")
                            {
                                //  SQLString = "Select   a.hsrprecordID,a.roundoff_netamount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate,a.mobileNo, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID where a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and HsrpRecord_creationdate between '" + AuthorizationDate + "' and  '" + ToDate + "' and   a.orderstatus='New Order' and vehicletype in ('THREE WHEELER') and [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null AND a.Addrecordby like'%dealer%' order by a.VehicleClass,a.VehicleType,a.VehicleRegNo";
                                SQLString = "Select   a.hsrprecordID,a.roundoff_netamount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate,a.mobileNo, a.EngineNo, a.ChassisNo, (select rtolocationname from rtolocation where rtolocationid=a.rtolocationid) RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass, a.HSRP_StateID, (select HSRPStateName from HSRPState where hsrp_stateid=a.hsrp_stateid) HSRPStateName, left (replace ((select productcode from product where productid=a.rearplatesize),'MM-',''),9) AS RearProductCode, left (replace ((select productcode from product where productid=a.frontplatesize),'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a   where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and HsrpRecord_creationdate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.orderstatus='New Order' and [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null AND  vehicletype in ('THREE WHEELER') and ( a.Addrecordby ='Dealer') order by a.VehicleClass,a.VehicleType,a.VehicleRegNo";
                            }
                            else if (DropDownList1.SelectedItem.ToString().ToUpper() == "FOUR WHEELER")
                            {
                                //SQLString = "Select   a.hsrprecordID,a.roundoff_netamount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate,a.mobileNo, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID where a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and HsrpRecord_creationdate between '" + AuthorizationDate + "' and  '" + ToDate + "' and   a.orderstatus='New Order' and vehicletype in ('LMV','LMV(CLASS)','MCV/HCV/TRAILERS','TRACTOR') and [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null AND a.Addrecordby like'%dealer%' order by a.VehicleClass,a.VehicleType,a.VehicleRegNo";
                                SQLString = "Select   a.hsrprecordID,a.roundoff_netamount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate,a.mobileNo, a.EngineNo, a.ChassisNo, (select rtolocationname from rtolocation where rtolocationid=a.rtolocationid) RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass, a.HSRP_StateID, (select HSRPStateName from HSRPState where hsrp_stateid=a.hsrp_stateid) HSRPStateName, left (replace ((select productcode from product where productid=a.rearplatesize),'MM-',''),9) AS RearProductCode, left (replace ((select productcode from product where productid=a.frontplatesize),'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a   where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and HsrpRecord_creationdate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.orderstatus='New Order' and [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null AND vehicletype in ('LMV','LMV(CLASS)','MCV/HCV/TRAILERS','TRACTOR') and ( a.Addrecordby ='Dealer') order by a.VehicleClass,a.VehicleType,a.VehicleRegNo";
                            }

                            //SQLString = "Select   a.hsrprecordID,a.netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate,a.mobileNo, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID where a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and PlateAffixationDate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.Addrecordby like'%dealer%' order by a.VehicleClass,a.VehicleType,a.VehicleRegNo";
                        }
                        else if (ddlBothDealerHHT.SelectedItem.Text == "HHT Data")
                        {
                            if (DropDownList1.SelectedItem.ToString().ToUpper() == "ALL")
                            {
                                SQLString = "Select   a.hsrprecordID,a.roundoff_netamount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate,a.mobileNo, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID  where a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and HsrpRecord_creationdate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.orderstatus='New Order' and [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null AND a.Addrecordby like'%HHT%'  order by a.VehicleClass,a.VehicleType,a.VehicleRegNo";
                            }
                            else if (DropDownList1.SelectedItem.ToString().ToUpper() == "TWO WHEELER")
                            {
                                SQLString = "Select   a.hsrprecordID,a.roundoff_netamount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate,a.mobileNo, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID  where a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and HsrpRecord_creationdate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.orderstatus='New Order' and vehicletype in ('MOTOR CYCLE','SCOOTER') AND [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null AND a.Addrecordby like'%HHT%'  order by a.VehicleClass,a.VehicleType,a.VehicleRegNo";
                            }
                            else if (DropDownList1.SelectedItem.ToString().ToUpper() == "THREE WHEELER")
                            {
                                SQLString = "Select   a.hsrprecordID,a.roundoff_netamount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate,a.mobileNo, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID  where a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and HsrpRecord_creationdate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.orderstatus='New Order' and vehicletype in ('THREE WHEELER') AND [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null AND a.Addrecordby like'%HHT%'  order by a.VehicleClass,a.VehicleType,a.VehicleRegNo";
                            }
                            else if (DropDownList1.SelectedItem.ToString().ToUpper() == "FOUR WHEELER")
                            {
                                SQLString = "Select   a.hsrprecordID,a.roundoff_netamount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate,a.mobileNo, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID  where a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and HsrpRecord_creationdate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.orderstatus='New Order' and vehicletype in ('LMV','LMV(CLASS)','MCV/HCV/TRAILERS','TRACTOR') AND [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null AND a.Addrecordby like'%HHT%'  order by a.VehicleClass,a.VehicleType,a.VehicleRegNo";
                            }
                            //SQLString = "Select   a.hsrprecordID,a.netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate,a.mobileNo, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID  where a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and PlateAffixationDate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.Addrecordby like'%HHT%'  order by a.VehicleClass,a.VehicleType,a.VehicleRegNo";
                        }
                        else if (ddlBothDealerHHT.SelectedItem.Text == "Other")
                        {
                            if (DropDownList1.SelectedItem.ToString().ToUpper() == "ALL")
                            {
                                SQLString = "Select   a.hsrprecordID,a.roundoff_netamount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate,a.mobileNo, a.EngineNo, a.ChassisNo, (select rtolocationname from rtolocation where rtolocationid=a.rtolocationid) RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass, a.HSRP_StateID, (select HSRPStateName from HSRPState where hsrp_stateid=a.hsrp_stateid) HSRPStateName, left (replace ((select productcode from product where productid=a.rearplatesize),'MM-',''),9) AS RearProductCode, left (replace ((select productcode from product where productid=a.frontplatesize),'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a   where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and HsrpRecord_creationdate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.orderstatus='New Order' and [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null AND (a.Addrecordby is null or a.Addrecordby !='Dealer') order by a.VehicleClass,a.VehicleType,a.VehicleRegNo";
                            }
                            else if (DropDownList1.SelectedItem.ToString().ToUpper() == "TWO WHEELER")
                            {
                                SQLString = "Select   a.hsrprecordID,a.roundoff_netamount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate,a.mobileNo, a.EngineNo, a.ChassisNo, (select rtolocationname from rtolocation where rtolocationid=a.rtolocationid) RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass, a.HSRP_StateID, (select HSRPStateName from HSRPState where hsrp_stateid=a.hsrp_stateid) HSRPStateName, left (replace ((select productcode from product where productid=a.rearplatesize),'MM-',''),9) AS RearProductCode, left (replace ((select productcode from product where productid=a.frontplatesize),'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a   where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and HsrpRecord_creationdate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.orderstatus='New Order' and [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null AND   vehicletype in ('MOTOR CYCLE','SCOOTER') and (a.Addrecordby is null or a.Addrecordby !='Dealer') order by a.VehicleClass,a.VehicleType,a.VehicleRegNo";
                            }
                            else if (DropDownList1.SelectedItem.ToString().ToUpper() == "THREE WHEELER")
                            {
                                SQLString = "Select   a.hsrprecordID,a.roundoff_netamount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate,a.mobileNo, a.EngineNo, a.ChassisNo, (select rtolocationname from rtolocation where rtolocationid=a.rtolocationid) RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass, a.HSRP_StateID, (select HSRPStateName from HSRPState where hsrp_stateid=a.hsrp_stateid) HSRPStateName, left (replace ((select productcode from product where productid=a.rearplatesize),'MM-',''),9) AS RearProductCode, left (replace ((select productcode from product where productid=a.frontplatesize),'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a   where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and HsrpRecord_creationdate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.orderstatus='New Order' and [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null AND   vehicletype in ('THREE WHEELER') and (a.Addrecordby is null or a.Addrecordby !='Dealer') order by a.VehicleClass,a.VehicleType,a.VehicleRegNo";
                            }
                            else if (DropDownList1.SelectedItem.ToString().ToUpper() == "FOUR WHEELER")
                            {
                                SQLString = "Select   a.hsrprecordID,a.roundoff_netamount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate,a.mobileNo, a.EngineNo, a.ChassisNo, (select rtolocationname from rtolocation where rtolocationid=a.rtolocationid) RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass, a.HSRP_StateID, (select HSRPStateName from HSRPState where hsrp_stateid=a.hsrp_stateid) HSRPStateName, left (replace ((select productcode from product where productid=a.rearplatesize),'MM-',''),9) AS RearProductCode, left (replace ((select productcode from product where productid=a.frontplatesize),'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a   where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and HsrpRecord_creationdate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.orderstatus='New Order' and [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null AND  vehicletype in ('LMV','LMV(CLASS)','MCV/HCV/TRAILERS','TRACTOR') and (a.Addrecordby is null or a.Addrecordby !='Dealer') order by a.VehicleClass,a.VehicleType,a.VehicleRegNo";
                            }
                            // SQLString = "Select   a.hsrprecordID,a.netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate,a.mobileNo, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID  where a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and PlateAffixationDate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.Addrecordby is null order by a.VehicleClass,a.VehicleType,a.VehicleRegNo";
                        }
                    }
                    else
                    {
                        if (ddlBothDealerHHT.SelectedItem.Text == "Both")
                        {
                            SQLString = "Select   a.hsrprecordID,a.roundoff_netamount as netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate,a.mobileNo, a.EngineNo, a.ChassisNo, (select rtolocationname from rtolocation where rtolocationid=a.rtolocationid) RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass, a.HSRP_StateID, (select HSRPStateName from HSRPState where hsrp_stateid=a.hsrp_stateid) HSRPStateName, left (replace ((select productcode from product where productid=a.rearplatesize),'MM-',''),9) AS RearProductCode, left (replace ((select productcode from product where productid=a.frontplatesize),'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a   where ApproveProductionStatus='N' and a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and HsrpRecord_creationdate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.orderstatus='New Order' and [HSRP_Front_LaserCode] is not null and [HSRP_Rear_LaserCode] is not null AND  order by a.VehicleClass,a.VehicleType,a.VehicleRegNo";
                        }
                        else if (ddlBothDealerHHT.SelectedItem.Text == "Dealer Data")
                        {
                            SQLString = "Select   a.hsrprecordID,a.netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID where a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and hsrprecord_CreationDate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.Addrecordby like'%dealer%'  order by a.VehicleType";
                        }
                        else if (ddlBothDealerHHT.SelectedItem.Text == "HHT Data")
                        {
                            SQLString = "Select   a.hsrprecordID,a.netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID where a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and hsrprecord_CreationDate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.Addrecordby  like'%HHT%'  order by a.VehicleType";
                        }
                        else if (ddlBothDealerHHT.SelectedItem.Text == "Other")
                        {
                            SQLString = "Select   a.hsrprecordID,a.netamount, a.HSRPRecord_AuthorizationNo,convert(varchar, OrderClosedDate, 105) as OrderClosedDate, CONVERT(varchar(20),orderdate ,103) AS OrderBookDate,CONVERT(varchar(20),OrderEmbossingDate ,103) AS OrderEmbossingDate,  left(a.OwnerName,19) as OwnerName, a.MobileNo, a.HSRPRecordID, CONVERT(varchar(20), HSRPRecord_AuthorizationDate,103) AS OrderDateAuth, a.OrderDate, a.EngineNo, a.ChassisNo, b.RTOLocationName,  a.VehicleRegNo,  case a.VehicleType when 'MCV/HCV/TRAILERS' then 'Trailers' when 'THREE WHEELER' then 'T.Whe.' when 'SCOOTER' then 'SCOO' when 'TRACTOR' then 'TRAC' when 'LMV(CLASS)' then 'L.CL' when 'LMV' then 'LMV'  when 'MOTOR CYCLE' then 'MO.C' end as VehicleType, case a.VehicleClass when 'Transport' then 'T' else 'N.T.' end as VehicleClass,  a.HSRP_StateID, s.HSRPStateName, left (replace (Product_1.ProductCode,'MM-',''),9) AS RearProductCode, left (replace (Product.ProductCode,'MM-',''),9) AS FrontProductCode, a.FrontPlateSize, a.HSRP_Front_LaserCode, a.HSRP_Rear_LaserCode, a.RearPlateSize FROM HSRPRecords AS a INNER JOIN HSRPState AS s ON a.HSRP_StateID = s.HSRP_StateID INNER JOIN Product ON a.FrontPlateSize = Product.ProductID INNER JOIN Product AS Product_1 ON a.RearPlateSize = Product_1.ProductID INNER JOIN RTOLocation AS b ON a.RTOLocationID = b.RTOLocationID where a.hsrp_StateID='" + DropDownListStateName.SelectedValue + "' and a.RTOLocationID='" + dropDownListClient.SelectedValue + "' and hsrprecord_CreationDate between '" + AuthorizationDate + "' and  '" + ToDate + "' and a.Addrecordby is null order by a.VehicleType";
                        }

                    }

                    DataTable dt = Utils.GetDataTable(SQLString, CnnString);
                    if (dt.Rows.Count > 0)
                    {
                        GridView1.DataSource = dt;
                        GridView1.DataBind();
                        btnApprove.Visible = true;
                    }
                    else
                    {
                        GridView1.DataSource = null;
                        GridView1.DataBind();
                        btnApprove.Visible = false;
                        lblErrMsg.Text = "";
                        lblErrMsg.Text = "No Record Found for Approval";

                    }

                }

            }
            catch (Exception ex)
            {
                lblErrMsg.Text = "Please Contact to  Adminstrator with Screen Shot. Error: " + ex.Message.ToString();
            }
        }      

        protected void GridView1_PageIndexChanging(object sender, GridViewPageEventArgs e)
        {
            
        }

        protected void GridView1_SelectedIndexChanged(object sender, EventArgs e)
        {

        }
        CheckBox chk;
        protected void CHKSelect1_CheckedChanged(object sender, EventArgs e)
        {
            try
            {
                CheckBox chk1 = GridView1.HeaderRow.FindControl("CHKSelect1") as CheckBox;
                if (chk1.Checked == true)
                {
                    for (int i = 0; i < GridView1.Rows.Count; i++)
                    {
                      
                        chk = GridView1.Rows[i].Cells[0].FindControl("CHKSelect") as CheckBox;
                        chk.Checked = true;
                    }
                }
                else if (chk1.Checked == false)
                {
                    for (int i = 0; i < GridView1.Rows.Count; i++)
                    {
                     
                        chk = GridView1.Rows[i].Cells[0].FindControl("CHKSelect") as CheckBox;
                        chk.Checked = false;
                    }
                }

            }

            catch (Exception ex)
            {
                lblErrMsg.Text = "Please Contact to  Adminstrator with Screen Shot. Error: " + ex.Message.ToString();
            }
        }

        protected void btnApprove_Click(object sender, EventArgs e)
        {

            int iChkCount = 0;
            try
            {
                for (int i = 0; i < GridView1.Rows.Count; i++)
                {
                    chk = GridView1.Rows[i].Cells[0].FindControl("CHKSelect") as CheckBox;

                    if (chk.Checked == true)
                    {
                        iChkCount = iChkCount + 1;
                        Label lblVehicleRegNo = GridView1.Rows[i].Cells[1].FindControl("lblVehicleRegNo") as Label;
                        string strRecordId = GridView1.DataKeys[i]["hsrprecordid"].ToString();
                        string SQLString1 = "update hsrprecords set ApproveProductionStatus='Y', ApprovedBy='" + strUserID + "', ApprovalDate=getdate() where hsrprecordID='" + strRecordId + "'";
                        int iResult = Utils.ExecNonQuery(SQLString1, CnnString);
                        if (!iResult.Equals(0))
                        {
                            string script = "<script type=\"text/javascript\">  alert('Saved Successfully');</script>";
                            Page.ClientScript.RegisterClientScriptBlock(this.GetType(), "Alert", script);
                            
                        }


                    }
                }
                btnDownloadRecords_Click(sender, e);
            }

            catch (Exception ex)
            {
                lblErrMsg.Text = "Please Contact to  Adminstrator with Screen Shot. Error: " + ex.Message.ToString();
            }

        }
    }
}
        
